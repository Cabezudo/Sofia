<style>
  #login {
    padding: 10px;
    width: 100%;
  }

  #login .form {
    background-color: white;
    display: flex;
    flex-direction: column;
  }

  #login .titleContainer {
    padding: 10px 0 20px 0;
  }

  #login .otherOption {
    font-size: #{theme.caption.option.font.size.default};
    text-align: center;
  }

  #login .footContainer {
    padding: 10px 0 20px 0;
    text-align: center;
  }

  #login .title {
    font-family: '#{theme.caption.title.font.family}';
    font-size: #{theme.caption.title.font.size.default};
    font-weight: bold;
    color: #333;
    line-height: calc(#{theme.caption.title.font.size.default} + 10px);
    text-align: center;

  }
  #loginMessageContainer {
    display: flex;
  }
  #loginMessage {
    text-align: center;
    margin: 50px 30px;
  }
  #loginMessage {
    font-size: #{theme.caption.text.font.size.default};
  }

  @media all and ( min-width: 480px ) {
    #login {
      width: 480px;
    }
    #loginMessageContainer {
      text-align: center;
    }
    #loginMessageContainer > div {
      width: 480px;
      text-align: center;
      margin: auto;
    }
  }
  @media all and ( min-width: 750px ) {
  }
  @media all and ( min-width: 1024px ) {
  }
  @media all and ( min-width: 1250px ) {
  }
  @media all and ( min-width: 1800px ) {
  }
</style>
<script>
  const loginForm = (() => {
    let loginEMailElement;
    let loginPasswordElement;
    let loginAcceptButton;
    let validEMail = false;
    let passwordValid = false;

    const changeAcceptButton = () => {
      if (validEMail && passwordValid) {
        Core.trigger(loginAcceptButton, 'enabled');
        Core.cleanMessagesContainer();
      } else {
        Core.trigger(loginAcceptButton, 'disabled');
      }
    };

    const createGUI = () => {
      loginEMailElement = Core.validateById('loginEMail');
      loginPasswordElement = Core.validateById('loginPassword');
      loginAcceptButton = Core.validateById('loginAcceptButton');

      inputEMailValidator_1_00_00({
        element: loginEMailElement,
        onValid: () => {
          validEMail = true;
          changeAcceptButton();
        },
        onNotValid: () => {
          validEMail = false;
          changeAcceptButton();
        },
        onKeyPress: event => {
          if (Core.isEnter(event)) {
            sendLoginInformation();
          }
        }
      });

      inputPasswordValidator_1_00_00({
        element: loginPasswordElement,
        onValid: () => {
          passwordValid = true;
          changeAcceptButton();
        },
        onNotValid: () => {
          passwordValid = false;
          changeAcceptButton();
        },
        onKeyPress: event => {
          if (Core.isEnter(event)) {
            sendLoginInformation();
          }
        }
      });

      greenButton_1_00_00({
        id: 'loginAcceptButton',
        enabled: false,
        onClick: () => {
          sendLoginInformation();
        },
        onResponse: event => {
          const data = event.detail;
          if (data.type === 'LOGIN' && data.messages.length === 1) {
            if (data.messages[0].status === 'VALID') {
              if (variables.comebackPage === null) {
                location.assign('#{afterLoginSucessfullPage}');
              } else {
                location.assign(variables.lastPage);
              }
            } else {
              Core.cleanMessagesContainer();
              Core.addMessage(data.messages[0]);
            }
          }
        }
      });
      messages_1_00_00({
        id: 'loginMessages'
      });
      const sendLoginInformation = () => {
        const formObject = {
          email: loginEMailElement.value,
          password: btoa(loginPasswordElement.value)
        };
        Core.sendPost(`/api/v1/users/login`, loginAcceptButton, 0, formObject);
      };
      loginEMailElement.focus();
    };
    Core.addOnloadFunction(createGUI);
  })();

</script>
<div id="login">
  <div id="loginFormContainer" class="form">
    <div class="titleContainer">
      <div class="title">#{title}</div>
      <div class="otherOption">o&nbsp;<a href="register.html">crear una cuenta</a></div>
    </div>
    <input id="loginEMail" type="email" name="username" placeholder="correo electrónico">
    <input id="loginPassword" type="password" name="password" placeholder="contraseña">
    <div id="loginMessages"></div>
    <div id="loginButton">Acceder</div>
    <div class="footContainer">
      <div class="otherOption">o&nbsp;<a href="#{recoverPasswordPage}">recuperar contraseña</a></div>
    </div>
  </div>
</div>
